<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Keluarga Berencana (KB) -  Lullaby.eca</title>
    <style>
        /* CSS DASAR & RESPONSIVE - TEMA MINT GREEN */
        body { font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; margin: 0; padding: 0; color: #333; background-color: #f1faf7; }
        header { background: #76c893; color: white; padding: 1.5rem; text-align: center; border-bottom: 5px solid #52b788; }
        
        nav { background: #52b788; padding: 0.8rem; text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav a { color: white; margin: 0 8px; text-decoration: none; font-weight: bold; font-size: 0.85rem; display: inline-block; }
        
        .container { padding: 15px; max-width: 900px; margin: auto; }
        .card { border: none; padding: 20px; border-radius: 15px; margin-bottom: 20px; background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        h2 { color: #2d6a4f; border-left: 5px solid #76c893; padding-left: 10px; margin-top: 0; margin-bottom: 15px; font-size: 1.3rem; }
        
        details { background: #f7fffb; border: 1px solid #d8f3dc; border-radius: 10px; margin-bottom: 12px; padding: 10px; transition: 0.3s; }
        details summary { font-weight: bold; color: #1b4332; cursor: pointer; outline: none; display: flex; align-items: center; list-style: none; }
        details summary img { width: 40px; margin-right: 15px; }
        details[open] { border: 1px solid #76c893; background: #fff; transform: scale(1.01); }

        .badge { display: inline-block; padding: 2px 8px; border-radius: 5px; font-size: 0.75rem; font-weight: bold; margin-bottom: 5px; }
        .plus { background: #d8f3dc; color: #1b4332; }
        .minus { background: #fee2e2; color: #991b1b; }

        .abpk-box { background: #e9f5ee; border-radius: 10px; padding: 15px; border-left: 5px solid #40916c; }
        
        /* Gaya Skrining & Hasil */
        .res-kb { display: none; margin-top: 15px; padding: 15px; border-radius: 10px; font-size: 0.85rem; animation: fadeIn 0.5s; }
        .res-danger-kb { background: #fff5f5; color: #c53030; border: 1px solid #feb2b2; font-weight: bold; }
        .res-safe-kb { background: #f0fff4; color: #276749; border: 1px solid #9ae6b4; font-weight: bold; }
        
        /* Tombol Modern */
        .btn-check-kb { 
            background: #52b788; color: white; border: none; padding: 14px; border-radius: 12px; 
            width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; 
            box-shadow: 0 4px 0 #40916c; transition: 0.2s;
        }
        .btn-check-kb:active { transform: translateY(3px); box-shadow: none; }

        .sadari-step { background: #f0fdf4; padding: 12px; border-radius: 8px; margin-bottom: 10px; border-left: 4px solid #10b981; font-size: 0.85rem; }

        /* Kalkulator Cards */
        .calc-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .calc-box { 
            background: #ffffff; padding: 20px; border-radius: 15px; 
            border: 2px solid #a3e635; position: relative; overflow: hidden;
            box-shadow: 0 5px 15px rgba(163, 230, 53, 0.1);
        }
        .calc-box i { font-size: 2rem; position: absolute; right: 10px; top: 10px; opacity: 0.1; }
        
        input[type="date"], input[type="number"] { 
            width: 100%; padding: 12px; border-radius: 10px; border: 2px solid #e2e8f0; 
            margin: 10px 0; box-sizing: border-box; font-size: 1rem;
        }
        input:focus { border-color: #76c893; outline: none; }

        footer { text-align: center; padding: 25px; background: #1b4332; color: white; margin-top: 30px; font-size: 0.8rem; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        @media (max-width: 600px) {
            header h1 { font-size: 1.5rem; }
            nav a { margin: 0 4px; font-size: 0.7rem; }
            .calc-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<header>
    <h1>Pelayanan KB & Konseling</h1>
    <p>Pilih Metode yang Tepat, Keluarga Sehat Sejahtera</p>
</header>

<nav>
    <a href="index.html">Beranda</a>
    <a href="kehamilan.html">Kehamilan</a>
    <a href="persalinan.html">Persalinan</a>
    <a href="nifas.html">Nifas</a>
    <a href="bbl.html">Bayi Baru Lahir</a>
    <a href="KB.html">KB</a>
    <a href="jurnal.html">Jurnal Kesehatan</a>
    <a href="tanya ibu.html">Lulleca AI</a>
	 <a href="gizi.html">Lulleca Gizi</a>
</nav>

<div class="container">

    <div class="card">
        <h2>Konseling ABPK</h2>
        <div class="abpk-box">
            <p style="margin-top: 0;"><b>Alat Bantu Pengambilan Keputusan (ABPK)</b> adalah panduan bagi Bidan dan Ibu untuk memilih metode KB yang paling sesuai.</p>
            <ul style="font-size: 0.85rem; padding-left: 20px;">
                <li>Membantu Ibu memilih metode sesuai kebutuhan.</li>
                <li>Memberikan informasi medis yang akurat.</li>
                <li>Menghilangkan mitos/ketakutan tentang KB.</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <h2>Pilihan Metode Kontrasepsi</h2>
        <p style="font-size: 0.85rem; color: #666; margin-bottom: 20px;">Klik pada gambar/nama alat untuk melihat detail:</p>

        <details>
            <summary><img src="inject.png"> KB Suntik (1 & 3 Bulan)</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Efektif, praktis, tidak ganggu hubungan intim.<br>
                <span class="badge minus">Kerugian:</span> Gangguan haid, berat badan bisa naik.
            </div>
        </details>

        <details>
            <summary><img src="pil.png"> Pil KB</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Kesuburan cepat kembali, kurangi nyeri haid.<br>
                <span class="badge minus">Kerugian:</span> Harus disiplin diminum tiap hari di jam yang sama.
            </div>
        </details>

        <details>
            <summary><img src="implant.png"> Implan (Susuk)</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Jangka panjang (3 tahun), tidak mengandung estrogen.<br>
                <span class="badge minus">Kerugian:</span> Perubahan pola haid, perlu tindakan bedah kecil.
            </div>
        </details>

        <details>
            <summary><img src="iud.png"> IUD (Spiral)</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Jangka sangat panjang (8-10 thn), non-hormonal.<br>
                <span class="badge minus">Kerugian:</span> Haid bisa lebih lama/banyak, risiko infeksi jika tak bersih.
            </div>
        </details>

        <details>
            <summary><img src="condom.png"> Kondom</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Cegah IMS/HIV, mudah didapat, tanpa hormon.<br>
                <span class="badge minus">Kerugian:</span> Efektivitas rendah jika cara pakai salah, risiko robek.
            </div>
        </details>

        <details>
            <summary><img src="breast-feed.png"> Metode Amenore Laktasi (MAL)</summary>
            <div style="padding: 10px; font-size: 0.85rem;">
                <span class="badge plus">Keuntungan:</span> Gratis, alami, dukung ASI Eksklusif.<br>
                <span class="badge minus">Kerugian:</span> Hanya berlaku 6 bulan & jika belum haid sama sekali.
            </div>
        </details>
    </div>

    <div class="card" style="border-top: 5px solid #ef4444;">
        <h2>üîç Skrining Kesehatan Reproduksi</h2>
        <p style="font-size: 0.8rem; color: #666;">Pilih "Ya" jika Ibu mengalami gejala berikut:</p>
        <div style="overflow-x: auto;">
            <table id="tableKB" style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                <tr style="background: #fee2e2; border-bottom: 2px solid #ef4444;">
                    <th style="padding: 12px; text-align: left;">Kondisi Ibu</th>
                    <th style="padding: 12px; text-align: center;">Ya</th>
                    <th style="padding: 12px; text-align: center;">Tidak</th>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">Perubahan bentuk/benjolan/cairan pada payudara (SADARI)</td>
                    <td align="center"><input type="radio" name="k1" value="ya"></td>
                    <td align="center"><input type="radio" name="k1" value="tidak" checked></td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">Keputihan berbau/gatal/warna tidak normal</td>
                    <td align="center"><input type="radio" name="k2" value="ya"></td>
                    <td align="center"><input type="radio" name="k2" value="tidak" checked></td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">Benjolan/kutil/luka di area vagina</td>
                    <td align="center"><input type="radio" name="k3" value="ya"></td>
                    <td align="center"><input type="radio" name="k3" value="tidak" checked></td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">Nyeri/perdarahan saat/setelah berhubungan</td>
                    <td align="center"><input type="radio" name="k4" value="ya"></td>
                    <td align="center"><input type="radio" name="k4" value="tidak" checked></td>
                </tr>
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 12px;">Nyeri saat BAK atau teraba benjolan di perut</td>
                    <td align="center"><input type="radio" name="k5" value="ya"></td>
                    <td align="center"><input type="radio" name="k5" value="tidak" checked></td>
                </tr>
            </table>
        </div>
        <button class="btn-check-kb" style="background: #ef4444; box-shadow: 0 4px 0 #b91c1c;" onclick="cekKesehatanKB()">Kirim & Cek Hasil Skrining</button>
        <div id="hasilKB" class="res-kb"></div>
    </div>

    <div class="card">
        <h2>üéÄ Cara SADARI (Periksa Payudara Sendiri)</h2>
        
        <p style="font-size: 0.85rem; color: #666; margin-bottom: 15px;">Lakukan 7-10 hari setelah menstruasi selesai:</p>
        <div class="sadari-step"><b>1. Di Depan Cermin:</b> Angkat kedua tangan, cek apakah ada kerutan atau tarikan pada puting.</div>
        <div class="sadari-step"><b>2. Gerakan Memutar:</b> Tekan perlahan payudara dengan 3 jari (telunjuk, tengah, manis) dari arah luar ke dalam menuju puting.</div>
        <div class="sadari-step"><b>3. Cek Cairan:</b> Pencet puting perlahan, pastikan tidak ada cairan berwarna/darah yang keluar.</div>
        <div class="sadari-step"><b>4. Area Ketiak:</b> Lakukan perabaan hingga area ketiak untuk mengecek benjolan.</div>
    </div>

    <div class="card">
        <h2>üìÖ Kalkulator & Reminder</h2>
        <div class="calc-grid">
            <div class="calc-box">
                <b style="color: #4a7c1b;">üå∏ Kalkulator Masa Subur</b>
                <p style="font-size: 0.75rem; margin-top: 5px;">Input Hari Pertama Haid Terakhir (HPHT):</p>
                <input type="date" id="hphtDate">
                <p style="font-size: 0.75rem;">Siklus rata-rata (Hari):</p>
                <input type="number" id="cycleDays" value="28">
                <button class="btn-check-kb" onclick="hitungSubur()">Hitung Masa Subur</button>
                <div id="resSubur" style="margin-top: 10px; font-size: 0.85rem; font-weight: bold; color: #1b4332;"></div>
            </div>

            <div class="calc-box" style="background: #fff5f7; border-color: #f472b6;">
                <b style="color: #be185d;">‚è∞ Reminder KB Suntik</b>
                <p style="font-size: 0.75rem; margin-top: 5px;">Tanggal Suntik Terakhir:</p>
                <input type="date" id="lastInject">
                <button class="btn-check-kb" style="background: #f472b6; box-shadow: 0 4px 0 #db2777;" onclick="hitungKembali()">Hitung Jadwal Kembali</button>
                <div id="resInject" style="margin-top: 10px; font-size: 0.85rem; font-weight: bold; color: #be185d;"></div>
            </div>
        </div>
    </div>

    <div class="card" style="text-align: center; background: #ecfdf5; border: 1px dashed #76c893;">
        <h3 style="color: #1b4332; margin-top: 0;">Ingat!</h3>
        <p style="font-size: 0.9rem;">Pilihlah metode kontrasepsi yang sesuai dengan kondisi kesehatan dan rencana masa depan keluarga Ibu.</p>
        <img src="https://cdn-icons-png.flaticon.com/512/3144/3144866.png" style="width: 80px;">
    </div>

</div>

<footer>
    <b>Kaiyisah Nadiya Hafizah</b><br>
    Asuhan Kebidanan Komprehensif di Puskesmas Simpang Rimba<br>
    Lullaby.eca 2026
</footer>

<script>
    // --- 1. KONFIGURASI TELEGRAM ---
    const TELEGRAM_TOKEN = "8151365194:AAFMl_JKjNFVTvo_8sJvhuieE1HnXZRaySc";
    const TELEGRAM_CHAT_ID = "6435649470";

    // --- 2. AMBIL DATA IDENTITAS LOGIN ---
    const namaUser = localStorage.getItem('user_nama') || "Bunda Tanpa Nama";
    const waUser = localStorage.getItem('user_wa') || "Tidak ada No WA";

    // --- 3. FUNGSI KIRIM LAPORAN (FORMAT SESUAI PERMINTAAN) ---
    async function kirimKeTelegram(keterangan) {
        const pesanLengkap = `üíä <b>LAPORAN KB LULLABY.ECA</b>\n` +
                             `----------------------------\n` +
                             `üë§ <b>Nama:</b> ${namaUser}\n` +
                             `üì± <b>WA:</b> ${waUser}\n` +
                             `üìù <b>Keterangan:</b>\n${keterangan}\n` +
                             `----------------------------`;

        const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
        try {
            await fetch(url, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ 
                    chat_id: TELEGRAM_CHAT_ID, 
                    text: pesanLengkap, 
                    parse_mode: "HTML" 
                })
            });
        } catch (error) {
            console.error("Gagal mengirim ke Telegram", error);
        }
    }

    // --- 4. FITUR CEK KESEHATAN KB ---
    function cekKesehatanKB() {
        let yaCount = 0;
        let ringkasan = "";
        document.querySelectorAll('#tableKB tr').forEach((row, index) => {
            if(index > 0) { // Lewati header
                let radioYa = row.querySelector('input[value="ya"]');
                if(radioYa && radioYa.checked) {
                    yaCount++;
                    ringkasan += `- ${row.cells[0].innerText}\n`;
                }
            }
        });

        let res = document.getElementById('hasilKB');
        res.style.display = "block";
        
        if(yaCount >= 1) {
            res.className = "res-kb res-danger-kb";
            res.innerHTML = "‚ö†Ô∏è Konsultasikan ke Bidan! Ada gejala yang memerlukan pemeriksaan lebih lanjut.";
            kirimKeTelegram(`üö® <b>SKRINING KB (BAHAYA)</b>\nDitemukan ${yaCount} keluhan:\n${ringkasan}`);
        } else {
            res.className = "res-kb res-safe-kb";
            res.innerHTML = "‚úÖ Sejauh ini kondisi Ibu normal. Silakan lanjutkan konseling metode KB pilihan Ibu.";
            kirimKeTelegram(`‚úÖ <b>SKRINING KB (NORMAL)</b>\nHasil skrining menunjukkan kondisi normal.`);
        }
    }

    // --- 5. FITUR KALKULATOR MASA SUBUR ---
    function hitungSubur() {
        const dateInput = document.getElementById('hphtDate').value;
        const cycle = parseInt(document.getElementById('cycleDays').value);
        if(!dateInput) return alert("Pilih tanggal haid terakhir!");
        
        let hpht = new Date(dateInput);
        let ovulasi = new Date(hpht);
        ovulasi.setDate(hpht.getDate() + (cycle - 14));
        
        let awal = new Date(ovulasi); awal.setDate(ovulasi.getDate() - 3);
        let akhir = new Date(ovulasi); akhir.setDate(ovulasi.getDate() + 3);

        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        let hasil = `${awal.toLocaleDateString('id-ID', options)} s/d ${akhir.toLocaleDateString('id-ID', options)}`;
        document.getElementById('resSubur').innerHTML = `üìç Perkiraan Masa Subur:<br>${hasil}`;
        
        kirimKeTelegram(`üå∏ <b>KALKULATOR MASA SUBUR</b>\nHPHT: ${dateInput}\nEstimasi Masa Subur: ${hasil}`);
    }

    // --- 6. FITUR REMINDER KB SUNTIK ---
    function hitungKembali() {
        const lastDate = document.getElementById('lastInject').value;
        if(!lastDate) return alert("Pilih tanggal suntik terakhir!");
        
        let tgl = new Date(lastDate);
        let kembali3Bln = new Date(tgl);
        kembali3Bln.setDate(tgl.getDate() + 84); // 12 minggu/84 hari

        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        let hasil = kembali3Bln.toLocaleDateString('id-ID', options);
        document.getElementById('resInject').innerHTML = `üìÖ Jadwal Suntik Kembali (3 Bulan):<br>${hasil}`;
        
        kirimKeTelegram(`‚è∞ <b>REMINDER KB SUNTIK</b>\nSuntik Terakhir: ${lastDate}\n<b>Jadwal Kembali: ${hasil}</b>`);
    }
</script>
</body>
</html>
